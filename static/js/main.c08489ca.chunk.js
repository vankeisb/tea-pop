(this.webpackJsonpdemo=this.webpackJsonpdemo||[]).push([[0],[,,,function(e,t,n){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n),Object.defineProperty(e,o,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||t.hasOwnProperty(n)||o(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(55),t),i(n(14),t),i(n(11),t),i(n(23),t),i(n(56),t),i(n(57),t)},function(e,t,n){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n),Object.defineProperty(e,o,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||t.hasOwnProperty(n)||o(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(24),t),i(n(15),t),i(n(16),t),i(n(59),t),i(n(60),t),i(n(61),t),i(n(62),t)},,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(58);Object.defineProperty(t,"dropDownOpen",{enumerable:!0,get:function(){return o.open}}),Object.defineProperty(t,"dropDownUpdate",{enumerable:!0,get:function(){return o.update}}),Object.defineProperty(t,"dropDownSubscriptions",{enumerable:!0,get:function(){return o.subscriptions}}),Object.defineProperty(t,"ViewDropDown",{enumerable:!0,get:function(){return o.ViewDropDown}})},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.dim=t.Dim=void 0;class o{constructor(e,t){this.w=e,this.h=t}}function i(e,t){return new o(e,null!==t&&void 0!==t?t:e)}t.Dim=o,o.zero=i(0),t.dim=i},,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.pos=t.Pos=void 0;class o{constructor(e,t){this.x=e,this.y=t}add(e){return new o(this.x+e.x,this.y+e.y)}}function i(e,t){return new o(e,t)}t.Pos=o,o.origin=i(0,0),t.pos=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.docMouseDown=t.gotItemBox=t.childMsg=t.gotKeyDown=t.gotMenuBox=t.gotUuid=t.gotWindowDimensions=t.noop=void 0,t.noop=function(){return{tag:"noop"}},t.gotWindowDimensions=function(e){return{tag:"got-window-dimensions",d:e}},t.gotUuid=function(e){return{tag:"got-uuid",uuid:e}},t.gotMenuBox=function(e){return{tag:"got-menu-box",r:e}},t.gotKeyDown=function(e){return{tag:"key-down",key:e}},t.childMsg=function(e){return{tag:"child-msg",m:e}},t.gotItemBox=function(e,t,n,o){return{tag:"got-item-box",item:e,selectFirst:o,r:t,subMenuCounter:n}},t.docMouseDown=function(){return{tag:"doc-mouse-down"}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.menuItemTask=t.menuTask=t.menuItemId=t.menuId=t.separator=t.item=t.menu=t.Menu=void 0;const o=n(0);class i{constructor(e){this.elements=e}selectFirstItem(){return new i(this.elements.selectIndex(0))}selectItem(e){return new i(this.elements.select(t=>t===e))}deselectAll(){return new i(o.ListWithSelection.fromArray(this.elements.toArray()))}get elems(){return this.elements.toArray()}get selectedItem(){const e=this.elements.getSelected();return"Just"===e.type&&"item"===e.value.tag?o.just(e.value):o.nothing}isSelected(e){return this.elements.isSelected(e)}findNextItemIndex(e){const t=this.elems;for(let n=e===t.length-1?0:e+1;n<t.length;n++)if("item"===t[n].tag)return o.just(n);return o.nothing}findPreviousItemIndex(e){const t=this.elems;for(let n=0===e?t.length-1:e-1;n>=0;n--)if("item"===t[n].tag)return o.just(n);return o.nothing}moveSelection(e){return this.elements.getSelectedIndex().map(t=>(e?this.findNextItemIndex(t):this.findPreviousItemIndex(t)).map(e=>new i(this.elements.selectIndex(e))).withDefault(this)).withDefaultSupply(()=>new i(this.elements.selectIndex(e?0:this.elements.length()-1)))}indexOfItem(e){const t=this.elements.toArray().indexOf(e);return-1===t?o.nothing:o.just(t)}}function r(e){return"tm-".concat(btoa(e))}function a(e,t){return"tm-item-".concat(e,"-").concat(t)}function u(e){return o.Task.fromLambda(()=>{const t=document.getElementById(e);if(null===t)throw new Error("element not found with id:"+e);return t})}t.Menu=i,t.menu=function(e){return new i(o.ListWithSelection.fromArray(e))},t.item=function(e,t){return{tag:"item",userData:e,subMenu:o.maybeOf(t)}},t.separator={tag:"separator"},t.menuId=r,t.menuItemId=a,t.menuTask=function(e){return u(r(e))},t.menuItemTask=function(e,t){return u(a(e,t))}},,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.box=t.Box=void 0;const o=n(14),i=n(11);class r{constructor(e,t){this.p=e,this.d=t}static fromDomRect(e){const t=e.x,n=e.y,r=e.height,u=e.width;return a(o.pos(t,n),i.dim(u,r))}}function a(e,t){return new r(e,t)}t.Box=r,t.box=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.keyboardNavigated=t.menuStatePlacing=t.initialModel=void 0;const o=n(0);function i(e){return{tag:"placing",refBox:e}}t.initialModel=function(e,t){return{uuid:o.nothing,windowSize:o.nothing,menu:e,state:i(t),error:o.nothing,child:o.nothing,navigatedWithKeyboard:!1,subMenuCounter:0}},t.menuStatePlacing=i,t.keyboardNavigated=function(e,t=!0){return Object.assign(Object.assign({},e),{navigatedWithKeyboard:t})}},,function(e,t,n){e.exports=n(63)},,,,,function(e,t,n){},function(e,t,n){},,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.stopEvent=void 0,t.stopEvent=e=>{e.preventDefault(),e.stopPropagation()}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.place1DStart=t.place1DEnd=t.placeCombo=t.place=void 0;const o=n(23),i=n(11),r=n(14);function a(e,t,n,o){if(t+n+o>e){if(o<t)return{offset:t-o,len:o};if(o<e){return{offset:t+n-(t+n+o-e),len:o}}return{offset:0,len:e}}return{offset:t+n,len:o}}function u(e,t,n,o){if(o>e)return{offset:0,len:e};if(t+o>e){if(o<t+n)return{offset:t+n-o,len:o};if(o<e){return{offset:t+n-(t+n+o-e),len:o}}return{offset:0,len:10}}return{offset:t,len:o}}t.place=function(e,t,n){const c=a(e.w,t.p.x,t.d.w,n.w),s=u(e.h,t.p.y,t.d.h,n.h);return o.box(r.pos(c.offset,s.offset),i.dim(c.len,s.len))},t.placeCombo=function(e,t,n){const a=u(e.w,t.p.x,t.d.w,n.w),c=function(e,t,n,o){const i=t+n,r=t,a=e-i;return o<a?{offset:i,len:o}:o<r?{offset:t-o,len:o}:r>a?{offset:0,len:r}:{offset:i,len:a}}(e.h,t.p.y,t.d.h,n.h);return o.box(r.pos(a.offset,c.offset),i.dim(a.len,c.len))},t.place1DEnd=a,t.place1DStart=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.windowDimensions=void 0;const o=n(11);t.windowDimensions=function(){return o.dim(window.innerWidth,window.innerHeight)}},function(e,t,n){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n),Object.defineProperty(e,o,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.hasOwnProperty.call(e,n)&&o(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.subscriptions=t.update=t.ViewDropDown=t.open=void 0;const a=r(n(1)),u=n(3),c=n(0);function s(e){return{tag:"got-rendered-box",r:e}}function d(e){return{tag:"got-init-data",r:e}}const m={tag:"noop"},l={tag:"request-close"};function p(e){return console.error(e),g(c.noCmd({tag:"error",e:e}))}function g(e,t=!1){return[e[0],e[1],t]}t.open=function(e){const t=c.Task.succeedLazy(()=>u.windowDimensions()),n=e.andThen(e=>t.andThen(t=>c.uuid().map(n=>({refBox:e,windowDimensions:t,uuid:n}))));return[{tag:"fresh"},c.Task.attempt(n,d)]},t.ViewDropDown=function(e){const t=e.renderer,n=e.model;switch(n.tag){case"fresh":return a.createElement("div",{className:"tm-drop-down tm-placing",style:{position:"absolute",top:0,left:0,visibility:"hidden"}},t());case"error":return a.createElement(a.Fragment,null);case"ready":return n.placed.map(e=>{const o=e.p,i=e.d;return a.createElement("div",{id:n.initData.uuid,className:"tm-drop-down tm-placed",style:{position:"absolute",top:o.y,left:o.x,width:i.w,height:i.h}},t())}).withDefaultSupply(()=>a.createElement("div",{id:n.initData.uuid,className:"tm-drop-down tm-placing",style:{position:"absolute",top:0,left:0,visibility:"hidden"}},t()))}},t.update=function(e,t){switch(e.tag){case"got-init-data":return"fresh"!==t.tag?g(c.noCmd(t)):e.r.match(e=>[{tag:"ready",initData:e,placed:c.nothing},c.Task.attempt(function(e){return(t=e,c.Task.fromLambda(()=>{const e=document.getElementById(t);if(!e)throw new Error("element not found "+t);return e})).map(e=>u.Box.fromDomRect(e.getBoundingClientRect()));var t}(e.uuid),s),!1],p);case"got-rendered-box":return e.r.match(e=>{if("ready"!==t.tag)return g(c.noCmd(t));const n=t.initData,o=n.windowDimensions,i=n.refBox,r=u.placeCombo(o,i,e.d);return g(c.noCmd(Object.assign(Object.assign({},t),{placed:c.just(r)})))},p);case"request-close":return g([t,c.Cmd.none()],!0);case"noop":return g(c.noCmd(t))}};const f=new c.DocumentEvents;t.subscriptions=function(){return c.Sub.batch([f.on("keydown",e=>"Escape"===e.key?l:m),f.on("mousedown",e=>{let t=e.target;for(;t;){if(t.classList.contains("tm-drop-down"))return m;t=t.parentElement}return l})])}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.subscriptions=t.update=t.open=void 0;const o=n(15),i=n(0),r=n(24),a=n(16),u=n(3);function c(e,t,n=!1){return[r.initialModel(n?e.selectFirstItem():e.deselectAll(),t),i.Cmd.batch([i.Task.perform(f,e=>o.gotWindowDimensions(e)),i.Task.perform(i.uuid(),e=>o.gotUuid(e))])]}function s(e){if("Nothing"===e.uuid.type)return i.noCmd(e);if("Nothing"===e.windowSize.type)return i.noCmd(e);return[e,i.Task.attempt(a.menuTask(e.uuid.value).map(e=>u.Box.fromDomRect(e.getBoundingClientRect())),e=>o.gotMenuBox(e))]}function d(e,t=i.nothing){return[e[0],e[1],t]}function m(e){return i.just({tag:"item-selected",data:e.userData})}function l(e,t,n,r,c){if(n.subMenu.isNothing())return i.noCmd(e);const s=e.subMenuCounter+1;return i.Tuple.t2n(Object.assign(Object.assign({},e),{subMenuCounter:s}),i.Task.attempt(a.menuItemTask(t,r).map(e=>u.Box.fromDomRect(e.getBoundingClientRect())),e=>o.gotItemBox(n,e,s,c)))}t.open=c,t.update=function e(t,n){switch(t.tag){case"got-window-dimensions":return d(s(Object.assign(Object.assign({},n),{windowSize:i.just(t.d)})));case"got-uuid":return d(s(Object.assign(Object.assign({},n),{uuid:i.just(t.uuid)})));case"got-menu-box":if("placing"===n.state.tag){const e=n.state;return d(i.noCmd(n.windowSize.map(o=>t.r.match(t=>Object.assign(Object.assign({},n),{state:{tag:"open",box:u.place(o,e.refBox,t.d)}}),e=>Object.assign(Object.assign({},n),{error:i.just(e)}))).withDefault(n)))}return d(i.noCmd(n));case"key-down":switch(t.key){case"Escape":return d(h(r.keyboardNavigated(n)),n.child.isNothing()?i.just({tag:"request-close"}):i.nothing);case"ArrowDown":case"ArrowUp":return b(r.keyboardNavigated(n),e=>d(i.noCmd(Object.assign(Object.assign({},e),{menu:e.menu.moveSelection("ArrowDown"===t.key)}))));case"ArrowLeft":return d(h(r.keyboardNavigated(n)));case"ArrowRight":return function(e){return b(e,e=>e.menu.selectedItem.map(t=>t.subMenu.map(()=>{if("Nothing"===e.uuid.type)return d(i.noCmd(e));const n=e.uuid.value;return d(e.menu.indexOfItem(t).map(o=>l(e,n,t,o,!0)).withDefaultSupply(()=>i.noCmd(e)))}).withDefaultSupply(()=>d(i.noCmd(e)))).withDefaultSupply(()=>d(i.noCmd(e))))}(r.keyboardNavigated(n));case"Enter":case" ":return function(e){return b(e,e=>e.menu.selectedItem.map(t=>{if("Nothing"===e.uuid.type)return d(i.noCmd(e));const n=e.uuid.value;return t.subMenu.map(()=>d(e.menu.indexOfItem(t).map(o=>l(e,n,t,o,!0)).withDefaultSupply(()=>i.noCmd(e)))).withDefaultSupply(()=>d(i.noCmd(e),m(t)))}).withDefaultSupply(()=>d(i.noCmd(e))))}(n);default:return d(i.noCmd(n))}case"mouse-move":{if(n.menu.isSelected(t.item))return d(i.noCmd(n));const e=Object.assign(Object.assign({},n),{subMenuCounter:n.subMenuCounter+1});if(n.navigatedWithKeyboard)return d(i.noCmd(r.keyboardNavigated(e,!1)));if("Nothing"===n.uuid.type)return d(i.noCmd(e));const o=n.menu.selectItem(t.item),a=n.uuid.value;return d(l(Object.assign(Object.assign({},e),{menu:o,child:i.nothing}),a,t.item,t.itemIndex,!1))}case"mouse-leave":return d(i.noCmd(n.child.isJust()?n:Object.assign(Object.assign({},n),{menu:n.menu.deselectAll()})));case"got-item-box":return t.subMenuCounter!==n.subMenuCounter?d(i.noCmd(n)):d(t.r.match(e=>{const r=Object.assign(Object.assign({},n),{menu:n.menu.selectItem(t.item)});return t.item.subMenu.map(n=>{const a=c(n,e,t.selectFirst),u=Object.assign(Object.assign({},r),{child:i.just(a[0])});return i.Tuple.t2n(u,a[1].map(o.childMsg))}).withDefaultSupply(()=>r.child.map(()=>i.noCmd(Object.assign(Object.assign({},n),{child:i.nothing}))).withDefaultSupply(()=>i.noCmd(n)))},e=>i.noCmd(Object.assign(Object.assign({},n),{error:i.just(e)}))));case"child-msg":return n.child.map(r=>{const a=e(t.m,r),u=Object.assign(Object.assign({},n),{child:i.just(a[0])});return d(i.Tuple.t2n(u,a[1].map(o.childMsg)),a[2])}).withDefaultSupply(()=>d(i.noCmd(n)));case"item-clicked":return d(i.noCmd(n),m(t.item));case"doc-mouse-down":return d(i.noCmd(n),i.just({tag:"request-close"}));case"noop":return d(i.noCmd(n))}};const p=new i.WindowEvents,g=new i.DocumentEvents;t.subscriptions=function(e){return i.Sub.batch([p.on("resize",()=>o.gotWindowDimensions(u.dim(window.innerWidth,window.innerHeight))),g.on("mousedown",e=>{if(2===e.button)return o.noop();let t=e.target;for(;t;){if(t.classList.contains("tm"))return o.noop();t=t.parentElement}return o.docMouseDown()}),"open"===e.state.tag?g.on("keydown",e=>o.gotKeyDown(e.key)):i.Sub.none()])};const f=i.Task.succeedLazy(()=>u.dim(window.innerWidth,window.innerHeight));function b(e,t){switch(e.child.type){case"Nothing":return t(e);case"Just":{const n=b(e.child.value,t);return[Object.assign(Object.assign({},e),{child:i.just(n[0])}),n[1].map(o.childMsg),n[2]]}}}function h(e){switch(e.child.type){case"Nothing":return i.noCmd(e);case"Just":{const t=e.child.value;return t.child.isJust()?i.Tuple.fromNative(h(t)).mapFirst(t=>Object.assign(Object.assign({},e),{child:i.just(t)})).mapSecond(e=>e.map(o.childMsg)).toNative():i.noCmd(Object.assign(Object.assign({},e),{child:i.nothing}))}}}},function(e,t,n){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n),Object.defineProperty(e,o,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.hasOwnProperty.call(e,n)&&o(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.ViewMenuItem=t.ViewMenu=void 0;const a=r(n(1)),u=n(16),c=n(15),s=n(0),d=n(3);function m(e){const t=e.menu,n=e.item,o=e.renderer,i=e.dispatch,r=e.uuid,c=e.itemIndex,s=t.isSelected(n);return a.createElement("div",{id:u.menuItemId(r,c),onMouseMove:()=>i({tag:"mouse-move",item:n,itemIndex:c}),onMouseLeave:()=>i({tag:"mouse-leave",item:n,itemIndex:c}),onClick:()=>{i({tag:"item-clicked",item:n})}},o({data:n.userData,active:s,hasSubMenu:n.subMenu.isJust()}))}t.ViewMenu=function e(t){const n=t.model,o=t.dispatch,i=t.renderer,r=n.menu,l=n.state,p=n.uuid,g=n.windowSize;if("Nothing"===p.type)return a.createElement(a.Fragment,null);if("Nothing"===g.type)return a.createElement(a.Fragment,null);const f=()=>r.elems.map((e,n)=>{switch(e.tag){case"item":return a.createElement(m,Object.assign({key:"item-".concat(n),uuid:p.value,itemIndex:n,menu:r,item:e},t));case"separator":return a.createElement("div",{key:"sep-".concat(n),className:"tm-separator"})}});switch(l.tag){case"placing":{const e=l.refBox;return a.createElement("div",{className:"tm-placer",style:{position:"absolute",top:0,left:0,bottom:0,right:0,overflow:"hidden"},onContextMenu:d.stopEvent},a.createElement("div",{className:"tm",id:u.menuId(p.value),style:{position:"absolute",top:e.p.y,left:e.p.x,visibility:"hidden"},onContextMenu:d.stopEvent},f()))}case"open":{const t=l.box,r=t.p,m=t.d;return a.createElement(a.Fragment,null,a.createElement("div",{className:"tm",id:u.menuId(p.value),style:{position:"absolute",top:r.y,left:r.x,width:m.w,height:m.h},onContextMenu:d.stopEvent},f()),n.child.map(t=>a.createElement(e,{model:t,dispatch:s.map(o,c.childMsg),renderer:i})).withDefaultSupply(()=>a.createElement(a.Fragment,null)))}}},t.ViewMenuItem=m},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,n){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n),Object.defineProperty(e,o,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.hasOwnProperty.call(e,n)&&o(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.defaultItemRenderer=void 0;const a=r(n(1));t.defaultItemRenderer=function(e){return t=>{const n=t.data,o=t.active,i=t.hasSubMenu,r=o?" tm-active":"";return a.createElement("div",{className:"tm-item".concat(r)},a.createElement("div",{className:"tm-item__content"},e(n)),i?a.createElement("div",{className:"tm-item__submenu"},"\u203a"):a.createElement(a.Fragment,null))}}},function(e,t,n){"use strict";n.r(t);var o=n(1),i=n.n(o),r=n(25),a=n.n(r),u=(n(31),n(32),n(0)),c=n(2),s=n(3),d=n(9),m=n(4);function l(){return{tag:"main-page",menuModel:u.nothing,lastClicked:u.nothing}}function p(e){return{tag:"dd-page-msg",m:e}}function g(e){return{tag:"main-page-msg",m:e}}function f(e){return{tag:"got-window-dimensions",d:e}}function b(e){return{tag:"menu-msg",msg:e}}function h(e){return{tag:"switch-page",page:e}}const w=Object(m.menu)([Object(m.item)("Try"),Object(m.item)("Finally")]),j=Object(m.menu)([Object(m.item)("Do this"),Object(m.item)("Do that"),m.separator,Object(m.item)("Another sub menu...",w)]),O=Object(m.menu)([Object(m.item)("Yalla",j),m.separator,Object(m.item)("Copy"),Object(m.item)("Cut"),Object(m.item)("Paste"),m.separator,Object(m.item)("I am a bit longer")]),v=Object(m.defaultItemRenderer)(e=>o.createElement("span",null,e));function y(){return Object(u.noCmd)({mousePos:s.Pos.origin,page:l()})}function D(e,t){switch(t.page.tag){case"main-page":return function(e,t){return o.createElement(o.Fragment,null,o.createElement("div",{className:"demo",onContextMenu:s.stopEvent,onMouseDown:t=>e(g({tag:"mouse-down",button:t.button}))},o.createElement("div",{className:"page-switch"},o.createElement("a",{href:"#",onClick:()=>e(h("drop-down-page"))},"Drop-down")," ","|"," ",o.createElement("a",{href:"#",onClick:()=>e(h("placement-page"))},"Placement tests")),t.menuModel.map(()=>o.createElement("span",null,"Menu is open")).withDefaultSupply(()=>t.lastClicked.map(e=>o.createElement("span",null,"You selected ",o.createElement("em",null,e))).withDefaultSupply(()=>o.createElement(o.Fragment,null,o.createElement("div",null,"Right-click anywhere, or use the ",o.createElement("code",null,"\u2263")," key."))))),t.menuModel.map(t=>o.createElement(m.ViewMenu,{model:t,dispatch:Object(u.map)(e,e=>g(b(e))),renderer:v})).withDefault(o.createElement(o.Fragment,null)))}(e,t.page);case"placement-page":return function(e,t,n){return n.viewportDim.map(e=>{let i="menu"===n.mode?s.place:s.placeCombo;const r=t.mousePos,a=Object(s.dim)(600,400),u=Object(s.dim)(100,50),c=i(e,Object(s.box)(Object(s.pos)(r.x,r.y),u),a),d=e=>o.createElement("span",null,e.w,"*",e.h),m=e=>o.createElement("span",null,e.x,":",e.y);return o.createElement("div",{className:"demo"},o.createElement("div",{className:"dimensions"},o.createElement("h1",null,"Placement tests (",o.createElement("code",null,"x")," to close)"),o.createElement("ul",null,o.createElement("li",null,"mode: ",n.mode," (toggle with ",o.createElement("code",null,"M"),")"),o.createElement("li",null,"elem: ",d(a)),o.createElement("li",null,"viewport: ",d(e)),o.createElement("li",null,"ref: ",d(u)),o.createElement("li",null,"mousePos: ",m(r)),o.createElement("li",null,"placed: ",m(c.p),", ",d(c.d)))),o.createElement("div",{className:"ref-elem",style:{height:u.h,width:u.w,left:t.mousePos.x,top:t.mousePos.y}}),o.createElement("div",{className:"menu-elem",style:{height:c.d.h,width:c.d.w,left:c.p.x,top:c.p.y}}))}).withDefaultSupply(()=>o.createElement(o.Fragment,null))}(0,t,t.page);case"drop-down-page":return function(e,t){return t.viewportDim.map(n=>{const i=Math.floor(n.w/10),r=Math.floor(n.h/10),a=[];let u=1;const c=r-8,m=i-8;for(let d=0;d+4+m<n.w;d+=i)for(let i=0;i+4+c<n.h;i+=r){const n=u,r=i+4,l=d+4,g=t.indexAndModel.map(e=>e.a).filter(e=>e===n).map(()=>"lightblue").withDefault("lightgray");a.push(o.createElement("button",{key:"btn"+u,style:{position:"absolute",top:r,left:l,height:c,width:m,border:"none",backgroundColor:g},onClick:t=>e(p({tag:"button-clicked",index:n,b:s.Box.fromDomRect(t.target.getBoundingClientRect())}))},u)),u++}return o.createElement(o.Fragment,null,o.createElement("div",{className:"drop-down-page"},a),t.indexAndModel.map(e=>o.createElement(d.ViewDropDown,{renderer:()=>o.createElement("div",{className:"my-drop-down"},"HELLO"),model:e.b})).withDefaultSupply(()=>o.createElement(o.Fragment,null)))}).withDefaultSupply(()=>o.createElement(o.Fragment,null))}(e,t.page)}}function M(e,t){switch(e.tag){case"main-page-msg":{if("main-page"!==t.page.tag)return Object(u.noCmd)(t);const n=e.m,o=t.page;switch(n.tag){case"menu-msg":{if("Nothing"===o.menuModel.type)return Object(u.noCmd)(t);const e=o.menuModel.value,i=Object(m.update)(n.msg,e),r=Object(c.a)(Object(c.a)({},o),{},{menuModel:Object(u.just)(i[0])}),a=Object(c.a)(Object(c.a)({},t),{},{page:r}),s=i[1].map(b).map(g),d=[a,s];return i[2].map(e=>{switch(e.tag){case"request-close":{const e=k(a);return u.Tuple.fromNative(e).mapSecond(e=>u.Cmd.batch([s,e])).toNative()}case"item-selected":{const t=k(a,Object(u.just)(e.data));return u.Tuple.fromNative(t).mapSecond(e=>u.Cmd.batch([s,e])).toNative()}}}).withDefault(d)}case"mouse-down":return 2===n.button?_(t,Object(m.open)(O,Object(s.box)(t.mousePos,s.Dim.zero))):Object(u.noCmd)(t)}break}case"key-down":switch(t.page.tag){case"main-page":return"ContextMenu"===e.key?_(t,Object(m.open)(O,Object(s.box)(t.mousePos,s.Dim.zero))):Object(u.noCmd)(t);case"placement-page":{const n=t.page;switch(e.key){case"x":return Object(u.noCmd)(Object(c.a)(Object(c.a)({},t),{},{page:l()}));case"m":return Object(u.noCmd)(Object(c.a)(Object(c.a)({},t),{},{page:Object(c.a)(Object(c.a)({},n),{},{mode:"menu"===n.mode?"drop-down":"menu"})}));default:return Object(u.noCmd)(t)}}case"drop-down-page":switch(e.key){case"x":return Object(u.noCmd)(Object(c.a)(Object(c.a)({},t),{},{page:l()}))}return Object(u.noCmd)(t)}break;case"mouse-move":return Object(u.noCmd)(Object(c.a)(Object(c.a)({},t),{},{mousePos:e.pos}));case"switch-page":switch(e.page){case"main-page":return function(e){return Object(u.noCmd)(Object(c.a)(Object(c.a)({},e),{},{page:l()}))}(t);case"drop-down-page":return function(e){const t=u.Task.succeedLazy(()=>Object(s.windowDimensions)());return u.Tuple.t2n(Object(c.a)(Object(c.a)({},e),{},{page:{tag:"drop-down-page",viewportDim:u.nothing,indexAndModel:u.nothing}}),u.Task.perform(t,f))}(t);case"placement-page":return function(e){return u.Tuple.t2n(Object(c.a)(Object(c.a)({},e),{},{page:{tag:"placement-page",viewportDim:u.nothing,refDim:Object(s.dim)(100),mode:"menu"}}),u.Task.perform(u.Task.succeedLazy(()=>Object(s.dim)(window.innerWidth,window.innerHeight)),f))}(t)}break;case"got-window-dimensions":if("placement-page"===t.page.tag||"drop-down-page"===t.page.tag){const n=t.page;return Object(u.noCmd)(Object(c.a)(Object(c.a)({},t),{},{page:Object(c.a)(Object(c.a)({},n),{},{viewportDim:Object(u.just)(e.d)})}))}return Object(u.noCmd)(t);case"dd-page-msg":{if("drop-down-page"!==t.page.tag)return Object(u.noCmd)(t);const n=t.page,o=e.m;switch(o.tag){case"button-clicked":{const e=Object(d.dropDownOpen)(u.Task.succeed(o.b));return u.Tuple.fromNative(e).mapFirst(e=>Object(c.a)(Object(c.a)({},t),{},{page:Object(c.a)(Object(c.a)({},n),{},{indexAndModel:Object(u.just)(new u.Tuple(o.index,e))})})).mapSecond(e=>e.map(e=>p({tag:"dd-msg",m:e}))).toNative()}case"dd-msg":return t.page.indexAndModel.map(e=>{const i=Object(d.dropDownUpdate)(o.m,e.b);if(i[2]){const e=Object(c.a)(Object(c.a)({},t),{},{page:Object(c.a)(Object(c.a)({},n),{},{indexAndModel:u.nothing})});return Object(u.noCmd)(e)}return u.Tuple.fromNative([i[0],i[1]]).mapFirst(e=>Object(c.a)(Object(c.a)({},t),{},{page:Object(c.a)(Object(c.a)({},n),{},{indexAndModel:n.indexAndModel.map(t=>new u.Tuple(t.a,e))})})).mapSecond(e=>e.map(e=>p({tag:"dd-msg",m:e}))).toNative()}).withDefaultSupply(()=>Object(u.noCmd)(t))}}}}const C=new u.DocumentEvents,x=new u.WindowEvents;function E(e){const t=C.on("mousemove",e=>({tag:"mouse-move",pos:Object(s.pos)(e.pageX,e.pageY)})),n=C.on("keydown",e=>({tag:"key-down",key:e.key}));switch(e.page.tag){case"main-page":{const o=e.page.menuModel.map(e=>Object(m.subscriptions)(e).map(b).map(g)).withDefaultSupply(()=>u.Sub.none());return u.Sub.batch([o,t,n])}case"placement-page":return u.Sub.batch([t,n,x.on("resize",e=>f(Object(s.dim)(window.innerWidth,window.innerHeight)))]);case"drop-down-page":return u.Sub.batch([Object(d.dropDownSubscriptions)().map(e=>p({tag:"dd-msg",m:e})),n,x.on("resize",e=>f(Object(s.dim)(window.innerWidth,window.innerHeight)))])}}function _(e,t){if("main-page"!==e.page.tag)return Object(u.noCmd)(e);const n=e.page;return u.Tuple.fromNative(t).mapFirst(t=>Object(c.a)(Object(c.a)({},e),{},{page:Object(c.a)(Object(c.a)({},n),{},{menuModel:Object(u.just)(t)})})).mapSecond(e=>e.map(b).map(g)).toNative()}function k(e,t=u.nothing){if("main-page"!==e.page.tag)return Object(u.noCmd)(e);const n=e.page,o=Object(c.a)(Object(c.a)({},e),{},{page:Object(c.a)(Object(c.a)({},n),{},{menuModel:u.nothing,lastClicked:t})});return Object(u.noCmd)(o)}var S=function(){return i.a.createElement(u.Program,{init:y,view:D,update:M,subscriptions:E,devTools:u.DevTools.init(window)})};a.a.render(i.a.createElement(i.a.StrictMode,null,i.a.createElement(S,null)),document.getElementById("root"))}],[[26,1,2]]]);
//# sourceMappingURL=main.c08489ca.chunk.js.map