(this.webpackJsonpdemo=this.webpackJsonpdemo||[]).push([[0],[,,function(e,t,n){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n),Object.defineProperty(e,o,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),r=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||t.hasOwnProperty(n)||o(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),r(n(57),t),r(n(17),t),r(n(12),t),r(n(25),t),r(n(58),t),r(n(59),t)},,,function(e,t,n){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n),Object.defineProperty(e,o,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),r=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||t.hasOwnProperty(n)||o(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),r(n(26),t),r(n(18),t),r(n(19),t),r(n(60),t),r(n(62),t),r(n(63),t),r(n(64),t)},,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(66);Object.defineProperty(t,"dropDownOpen",{enumerable:!0,get:function(){return o.open}}),Object.defineProperty(t,"dropDownUpdate",{enumerable:!0,get:function(){return o.update}}),Object.defineProperty(t,"dropDownSubscriptions",{enumerable:!0,get:function(){return o.subscriptions}}),Object.defineProperty(t,"ViewDropDown",{enumerable:!0,get:function(){return o.ViewDropDown}})},function(e,t,n){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n),Object.defineProperty(e,o,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),r=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||t.hasOwnProperty(n)||o(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0});var i=n(67);Object.defineProperty(t,"comboBoxInit",{enumerable:!0,get:function(){return i.init}}),Object.defineProperty(t,"comboBoxUpdate",{enumerable:!0,get:function(){return i.update}}),Object.defineProperty(t,"comboBoxSubscriptions",{enumerable:!0,get:function(){return i.subscriptions}}),r(n(69),t)},,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.dim=t.Dim=void 0;class o{constructor(e,t){this.w=e,this.h=t}}function r(e,t){return new o(e,null!==t&&void 0!==t?t:e)}t.Dim=o,o.zero=r(0),t.dim=r},,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.pos=t.Pos=void 0;class o{constructor(e,t){this.x=e,this.y=t}add(e){return new o(this.x+e.x,this.y+e.y)}}function r(e,t){return new o(e,t)}t.Pos=o,o.origin=r(0,0),t.pos=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.docMouseDown=t.gotItemBox=t.childMsg=t.gotKeyDown=t.gotMenuBox=t.gotUuid=t.gotwindowBlur=t.gotWindowDimensions=t.noop=void 0,t.noop=function(){return{tag:"noop"}},t.gotWindowDimensions=function(e){return{tag:"got-window-dimensions",d:e}},t.gotwindowBlur=function(){return{tag:"window-blur"}},t.gotUuid=function(e){return{tag:"got-uuid",uuid:e}},t.gotMenuBox=function(e){return{tag:"got-menu-box",r:e}},t.gotKeyDown=function(e){return{tag:"key-down",key:e}},t.childMsg=function(e){return{tag:"child-msg",m:e}},t.gotItemBox=function(e,t,n,o){return{tag:"got-item-box",item:e,selectFirst:o,r:t,subMenuCounter:n}},t.docMouseDown=function(){return{tag:"doc-mouse-down"}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.menuItemTask=t.menuTask=t.menuItemId=t.menuId=t.separator=t.item=t.menu=t.Menu=void 0;const o=n(0);class r{constructor(e){this.elements=e}selectFirstItem(){return new r(this.elements.selectIndex(0))}selectItem(e){return new r(this.elements.select(t=>t===e))}deselectAll(){return new r(o.ListWithSelection.fromArray(this.elements.toArray()))}get elems(){return this.elements.toArray()}get selectedItem(){const e=this.elements.getSelected();return"Just"===e.type&&"item"===e.value.tag?o.just(e.value):o.nothing}isSelected(e){return this.elements.isSelected(e)}findNextItemIndex(e){const t=this.elems;for(let n=e===t.length-1?0:e+1;n<t.length;n++)if("item"===t[n].tag)return o.just(n);return o.nothing}findPreviousItemIndex(e){const t=this.elems;for(let n=0===e?t.length-1:e-1;n>=0;n--)if("item"===t[n].tag)return o.just(n);return o.nothing}moveSelection(e){return this.elements.getSelectedIndex().map(t=>(e?this.findNextItemIndex(t):this.findPreviousItemIndex(t)).map(e=>new r(this.elements.selectIndex(e))).withDefault(this)).withDefaultSupply(()=>new r(this.elements.selectIndex(e?0:this.elements.length()-1)))}indexOfItem(e){const t=this.elements.toArray().indexOf(e);return-1===t?o.nothing:o.just(t)}}function i(e){return"tm-".concat(btoa(e))}function u(e,t){return"tm-item-".concat(e,"-").concat(t)}function a(e){return o.Task.fromLambda(()=>{const t=document.getElementById(e);if(null===t)throw new Error("element not found with id:"+e);return t})}t.Menu=r,t.menu=function(e){return new r(o.ListWithSelection.fromArray(e))},t.item=function(e,t){return{tag:"item",userData:e,subMenu:o.maybeOf(t)}},t.separator={tag:"separator"},t.menuId=i,t.menuItemId=u,t.menuTask=function(e){return a(i(e))},t.menuItemTask=function(e,t){return a(u(e,t))}},,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.box=t.Box=void 0;const o=n(17),r=n(12);class i{constructor(e,t){this.p=e,this.d=t}static fromDomRect(e){const t=e.x,n=e.y,i=e.height,a=e.width;return u(o.pos(t,n),r.dim(a,i))}get topLeft(){return this.p}get bottomRight(){return o.pos(this.right,this.bottom)}get left(){return this.p.x}get right(){return this.left+this.d.w}get top(){return this.p.y}get bottom(){return this.top+this.d.h}isPointInside(e){return!(e.x<this.left||e.x>this.right||e.y<this.top||e.y>this.bottom)}isBoxInside(e){return this.isPointInside(e.topLeft)&&this.isPointInside(e.bottomRight)}}function u(e,t){return new i(e,t)}t.Box=i,t.box=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.keyboardNavigated=t.menuStatePlacing=t.initialModel=void 0;const o=n(0);function r(e){return{tag:"placing",refBox:e}}t.initialModel=function(e,t){return{uuid:o.nothing,windowSize:o.nothing,menu:e,state:r(t),error:o.nothing,child:o.nothing,navigatedWithKeyboard:!1,subMenuCounter:0}},t.menuStatePlacing=r,t.keyboardNavigated=function(e,t=!0){return Object.assign(Object.assign({},e),{navigatedWithKeyboard:t})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.moveSelection=t.comboItemHtmlId=t.comboHtmlId=t.initialModel=void 0;const o=n(0);t.initialModel=function(){return{uuid:o.nothing,value:"",ddModel:o.nothing,items:o.nothing,fetchCount:0}},t.comboHtmlId=function(e){return"tp-cb-"+e},t.comboItemHtmlId=function(e,t){return"tp-cb-item-"+e+"-"+t},t.moveSelection=function(e,t){return Object.assign(Object.assign({},e),{items:e.items.map(e=>e.map(e=>{const n=e.length(),o=e.getSelectedIndex().withDefault(-1),r=t?o-1:o+1,i=r<0?n-1:r>=n?0:r;return e.selectIndex(i)}))})}},,function(e,t,n){e.exports=n(70)},,,,,function(e,t,n){},,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.stopEvent=void 0,t.stopEvent=e=>{e.preventDefault(),e.stopPropagation()}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.place1DStart=t.place1DEnd=t.placeCombo=t.place=void 0;const o=n(25),r=n(12),i=n(17);function u(e,t,n,o){if(t+n+o>e){if(o<t)return{offset:t-o,len:o};if(o<e){return{offset:t+n-(t+n+o-e),len:o}}return{offset:0,len:e}}return{offset:t+n,len:o}}function a(e,t,n,o){if(o>e)return{offset:0,len:e};if(t+o>e){if(o<t+n)return{offset:t+n-o,len:o};if(o<e){return{offset:t+n-(t+n+o-e),len:o}}return{offset:0,len:10}}return{offset:t,len:o}}t.place=function(e,t,n){const c=u(e.w,t.p.x,t.d.w,n.w),s=a(e.h,t.p.y,t.d.h,n.h);return o.box(i.pos(c.offset,s.offset),r.dim(c.len,s.len))},t.placeCombo=function(e,t,n){const u=a(e.w,t.p.x,t.d.w,n.w),c=function(e,t,n,o){const r=t+n,i=t,u=e-r;return o<u?{offset:r,len:o}:o<i?{offset:t-o,len:o}:i>u?{offset:0,len:i}:{offset:r,len:u}}(e.h,t.p.y,t.d.h,n.h);return o.box(i.pos(u.offset,c.offset),r.dim(u.len,c.len))},t.place1DEnd=u,t.place1DStart=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.windowDimensions=void 0;const o=n(12);t.windowDimensions=function(){return o.dim(window.innerWidth,window.innerHeight)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.subscriptions=t.update=t.open=void 0;const o=n(18),r=n(0),i=n(26),u=n(19),a=n(2),c=n(4),s=n(61);function m(e,t,n=!1){return s.log("teapop","open","refBox",t),[i.initialModel(n?e.selectFirstItem():e.deselectAll(),t),r.Cmd.batch([r.Task.perform(h,e=>o.gotWindowDimensions(e)),r.Task.perform(r.uuid(),e=>o.gotUuid(e))])]}function d(e){if("Nothing"===e.uuid.type)return r.noCmd(e);if("Nothing"===e.windowSize.type)return r.noCmd(e);return[e,r.Task.attempt(u.menuTask(e.uuid.value).map(e=>{const t=e.getBoundingClientRect(),n=a.Box.fromDomRect(t);return s.log("teapop","postOpen","menu box",n),n}),e=>o.gotMenuBox(e))]}function l(e,t=r.nothing){return[e[0],e[1],t]}function p(e){return r.just({tag:"item-selected",data:e.userData})}function g(e,t,n,i,c){if(n.subMenu.isNothing())return r.noCmd(e);const s=e.subMenuCounter+1;return r.Tuple.t2n(Object.assign(Object.assign({},e),{subMenuCounter:s}),r.Task.attempt(u.menuItemTask(t,i).map(e=>a.Box.fromDomRect(e.getBoundingClientRect())),e=>o.gotItemBox(n,e,s,c)))}t.open=m,t.update=function e(t,n){switch(t.tag){case"got-window-dimensions":return"open"===n.state.tag?l(r.noCmd(n),r.just({tag:"request-close"})):l(d(Object.assign(Object.assign({},n),{windowSize:r.just(t.d)})));case"window-blur":return l(r.noCmd(n),r.just({tag:"request-close"}));case"got-uuid":return l(d(Object.assign(Object.assign({},n),{uuid:r.just(t.uuid)})));case"got-menu-box":if("placing"===n.state.tag){const e=n.state;return l(r.noCmd(n.windowSize.map(o=>t.r.match(t=>{s.log("teapop","got-menu-box","menuBox",t);const r=a.place(o,e.refBox,t.d);return s.log("teapop","got-menu-box","placedBox",r),Object.assign(Object.assign({},n),{state:{tag:"open",box:r}})},e=>Object.assign(Object.assign({},n),{error:r.just(e)}))).withDefault(n)))}return s.log("teapop","got-menu-box","not placing"),l(r.noCmd(n));case"key-down":switch(t.key){case"Escape":return l(j(i.keyboardNavigated(n)),n.child.isNothing()?r.just({tag:"request-close"}):r.nothing);case"ArrowDown":case"ArrowUp":return w(i.keyboardNavigated(n),e=>l(r.noCmd(Object.assign(Object.assign({},e),{menu:e.menu.moveSelection("ArrowDown"===t.key)}))));case"ArrowLeft":return l(j(i.keyboardNavigated(n)));case"ArrowRight":return function(e){return w(e,e=>e.menu.selectedItem.map(t=>t.subMenu.map(()=>{if("Nothing"===e.uuid.type)return l(r.noCmd(e));const n=e.uuid.value;return l(e.menu.indexOfItem(t).map(o=>g(e,n,t,o,!0)).withDefaultSupply(()=>r.noCmd(e)))}).withDefaultSupply(()=>l(r.noCmd(e)))).withDefaultSupply(()=>l(r.noCmd(e))))}(i.keyboardNavigated(n));case"Enter":case" ":return function(e){return w(e,e=>e.menu.selectedItem.map(t=>{if("Nothing"===e.uuid.type)return l(r.noCmd(e));const n=e.uuid.value;return t.subMenu.map(()=>l(e.menu.indexOfItem(t).map(o=>g(e,n,t,o,!0)).withDefaultSupply(()=>r.noCmd(e)))).withDefaultSupply(()=>l(r.noCmd(e),p(t)))}).withDefaultSupply(()=>l(r.noCmd(e))))}(n);default:return l(r.noCmd(n))}case"mouse-move":{if(n.menu.isSelected(t.item))return l(r.noCmd(n));const e=Object.assign(Object.assign({},n),{subMenuCounter:n.subMenuCounter+1});if(n.navigatedWithKeyboard)return l(r.noCmd(i.keyboardNavigated(e,!1)));if("Nothing"===n.uuid.type)return l(r.noCmd(e));const o=n.menu.selectItem(t.item),u=n.uuid.value;return l(g(Object.assign(Object.assign({},e),{menu:o,child:r.nothing}),u,t.item,t.itemIndex,!1))}case"mouse-leave":return l(r.noCmd(n.child.isJust()?n:Object.assign(Object.assign({},n),{menu:n.menu.deselectAll()})));case"got-item-box":return t.subMenuCounter!==n.subMenuCounter?l(r.noCmd(n)):l(t.r.match(e=>{const i=Object.assign(Object.assign({},n),{menu:n.menu.selectItem(t.item)});return t.item.subMenu.map(n=>{const u=m(n,e,t.selectFirst),a=Object.assign(Object.assign({},i),{child:r.just(u[0])});return r.Tuple.t2n(a,u[1].map(o.childMsg))}).withDefaultSupply(()=>i.child.map(()=>r.noCmd(Object.assign(Object.assign({},n),{child:r.nothing}))).withDefaultSupply(()=>r.noCmd(n)))},e=>r.noCmd(Object.assign(Object.assign({},n),{error:r.just(e)}))));case"child-msg":return n.child.map(i=>{const u=e(t.m,i),a=Object.assign(Object.assign({},n),{child:r.just(u[0])});return l(r.Tuple.t2n(a,u[1].map(o.childMsg)),u[2])}).withDefaultSupply(()=>l(r.noCmd(n)));case"item-clicked":return l(r.noCmd(n),p(t.item));case"doc-mouse-down":return l(r.noCmd(n),r.just({tag:"request-close"}));case"noop":return l(r.noCmd(n))}};const f=new c.WindowEvents,b=new c.DocumentEvents;t.subscriptions=function(e){return r.Sub.batch([f.on("resize",()=>o.gotWindowDimensions(a.dim(window.innerWidth,window.innerHeight))),f.on("blur",()=>o.gotwindowBlur()),b.on("mousedown",e=>{if(2===e.button)return o.noop();let t=e.target;for(;t;){if(t.classList.contains("tm"))return o.noop();t=t.parentElement}return o.docMouseDown()}),"open"===e.state.tag?b.on("keydown",e=>o.gotKeyDown(e.key)):r.Sub.none()])};const h=r.Task.succeedLazy(()=>a.dim(window.innerWidth,window.innerHeight));function w(e,t){switch(e.child.type){case"Nothing":return t(e);case"Just":{const n=w(e.child.value,t);return[Object.assign(Object.assign({},e),{child:r.just(n[0])}),n[1].map(o.childMsg),n[2]]}}}function j(e){switch(e.child.type){case"Nothing":return r.noCmd(e);case"Just":{const t=e.child.value;return t.child.isJust()?r.Tuple.fromNative(j(t)).mapFirst(t=>Object.assign(Object.assign({},e),{child:r.just(t)})).mapSecond(e=>e.map(o.childMsg)).toNative():r.noCmd(Object.assign(Object.assign({},e),{child:r.nothing}))}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.log=void 0,t.log=function(...e){window.teaPopDebug&&console.log(...e)}},function(e,t,n){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n),Object.defineProperty(e,o,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),r=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.hasOwnProperty.call(e,n)&&o(t,e,n);return r(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.ViewMenuItem=t.ViewMenu=void 0;const u=i(n(1)),a=n(19),c=n(18),s=n(0),m=n(2);function d(e){const t=e.menu,n=e.item,o=e.renderer,r=e.dispatch,i=e.uuid,c=e.itemIndex,s=t.isSelected(n);return u.createElement("div",{id:a.menuItemId(i,c),onMouseMove:()=>r({tag:"mouse-move",item:n,itemIndex:c}),onMouseLeave:()=>r({tag:"mouse-leave",item:n,itemIndex:c}),onClick:()=>{r({tag:"item-clicked",item:n})}},o({data:n.userData,active:s,hasSubMenu:n.subMenu.isJust()}))}t.ViewMenu=function e(t){const n=t.model,o=t.dispatch,r=t.renderer,i=n.menu,l=n.state,p=n.uuid,g=n.windowSize;if("Nothing"===p.type)return u.createElement(u.Fragment,null);if("Nothing"===g.type)return u.createElement(u.Fragment,null);const f=()=>i.elems.map((e,n)=>{switch(e.tag){case"item":return u.createElement(d,Object.assign({key:"item-".concat(n),uuid:p.value,itemIndex:n,menu:i,item:e},t));case"separator":return u.createElement("div",{key:"sep-".concat(n),className:"tm-separator"})}});switch(l.tag){case"placing":{const e=l.refBox;return u.createElement("div",{className:"tm-placer",style:{position:"absolute",top:0,left:0,bottom:0,right:0,overflow:"hidden"},onContextMenu:m.stopEvent},u.createElement("div",{className:"tm",id:a.menuId(p.value),style:{position:"absolute",top:e.p.y,left:e.p.x,visibility:"hidden"},onContextMenu:m.stopEvent},f()))}case"open":{const t=l.box,i=t.p,d=t.d;return u.createElement(u.Fragment,null,u.createElement("div",{className:"tm",id:a.menuId(p.value),style:{position:"fixed",top:i.y,left:i.x,width:d.w,height:d.h},onContextMenu:m.stopEvent},f()),n.child.map(t=>u.createElement(e,{model:t,dispatch:s.map(o,c.childMsg),renderer:r})).withDefaultSupply(()=>u.createElement(u.Fragment,null)))}}},t.ViewMenuItem=d},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,n){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n),Object.defineProperty(e,o,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),r=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.hasOwnProperty.call(e,n)&&o(t,e,n);return r(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.defaultItemRenderer=void 0;const u=i(n(1));t.defaultItemRenderer=function(e){return t=>{const n=t.data,o=t.active,r=t.hasSubMenu,i=o?" tm-active":"";return u.createElement("div",{className:"tm-item".concat(i)},u.createElement("div",{className:"tm-item__content"},e(n)),r?u.createElement("div",{className:"tm-item__submenu"},"\u203a"):u.createElement(u.Fragment,null))}}},function(e,t,n){},function(e,t,n){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n),Object.defineProperty(e,o,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),r=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.hasOwnProperty.call(e,n)&&o(t,e,n);return r(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.subscriptions=t.update=t.ViewDropDown=t.open=void 0;const u=i(n(1)),a=n(2),c=n(0),s=n(4);function m(e){return{tag:"got-rendered-box",r:e}}function d(e){return{tag:"got-init-data",r:e}}const l={tag:"noop"},p={tag:"request-close"};function g(e){return console.error(e),f(c.noCmd({tag:"error",e:e}))}function f(e,t=!1){return[e[0],e[1],t]}t.open=function(e){const t=c.Task.succeedLazy(()=>a.windowDimensions()),n=e.andThen(e=>t.andThen(t=>c.uuid().map(n=>({refBox:e,windowDimensions:t,uuid:n}))));return[{tag:"fresh"},c.Task.attempt(n,d)]},t.ViewDropDown=function(e){const t=e.renderer,n=e.model;switch(n.tag){case"fresh":return u.createElement("div",{className:"tm-drop-down tm-placing",style:{position:"absolute",top:0,left:0,visibility:"hidden"}},t());case"error":return u.createElement(u.Fragment,null);case"ready":return n.placed.map(e=>{const o=e.p,r=e.d;return u.createElement("div",{id:n.initData.uuid,className:"tm-drop-down tm-placed",style:{position:"fixed",top:o.y,left:o.x,width:r.w,height:r.h}},t())}).withDefaultSupply(()=>u.createElement("div",{id:n.initData.uuid,className:"tm-drop-down tm-placing",style:{position:"absolute",top:0,left:0,visibility:"hidden"}},t()))}},t.update=function(e,t){switch(e.tag){case"got-init-data":return"fresh"!==t.tag?f(c.noCmd(t)):e.r.match(e=>[{tag:"ready",initData:e,placed:c.nothing},c.Task.attempt(function(e){return(t=e,c.Task.fromLambda(()=>{const e=document.getElementById(t);if(!e)throw new Error("element not found "+t);return e})).map(e=>a.Box.fromDomRect(e.getBoundingClientRect()));var t}(e.uuid),m),!1],g);case"got-rendered-box":return e.r.match(e=>{if("ready"!==t.tag)return f(c.noCmd(t));const n=t.initData,o=n.windowDimensions,r=n.refBox,i=a.placeCombo(o,r,e.d);return f(c.noCmd(Object.assign(Object.assign({},t),{placed:c.just(i)})))},g);case"request-close":return f([t,c.Cmd.none()],!0);case"noop":return f(c.noCmd(t))}};const b=new s.DocumentEvents;t.subscriptions=function(){return c.Sub.batch([b.on("keydown",e=>"Escape"===e.key?p:l),b.on("mousedown",e=>{let t=e.target;for(;t;){if(t.classList.contains("tm-drop-down"))return l;t=t.parentElement}return p})])}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.subscriptions=t.update=t.init=void 0;const o=n(0),r=n(2),i=n(8),u=n(27),a=n(68);function c(e,t){const n=e.fetchCount+1,r=Object.assign(Object.assign({},e),{fetchCount:n});return o.Tuple.t2n(r,o.Task.attempt(t.fetchItems(e.value),e=>a.gotItems(e,n)))}function s(e,t){return[t[0],t[1],e.value===t[0].value?o.nothing:o.just(t[0].value)]}function m(e,t,n){const r=Object.assign(Object.assign({},e),{value:t.itemToString(n)});return o.updatePiped(r,l,e=>o.Tuple.t2n(e,p(e)))}function d(e){return e.uuid.map(t=>{const n=o.Task.fromLambda(()=>{const e=document.getElementById(u.comboHtmlId(t));if(!e)throw new Error("input element not found");return r.Box.fromDomRect(e.getBoundingClientRect())}),c=i.dropDownOpen(n),s=Object.assign(Object.assign({},e),{ddModel:o.just(c[0])}),m=c[1].map(e=>a.dropDownMsg(e));return o.Tuple.t2n(s,o.Cmd.batch([m,p(e)]))}).withDefaultSupply(()=>o.noCmd(e))}function l(e){const t=Object.assign(Object.assign({},e),{ddModel:o.nothing,fetchCount:e.fetchCount+1});return o.noCmd(t)}function p(e){return e.uuid.map(e=>o.Task.attempt(function(e){return g(u.comboHtmlId(e))}(e).map(e=>(e.focus(),e)),e=>a.inputFocused(e))).withDefaultSupply(()=>o.Cmd.none())}function g(e){return o.Task.fromLambda(()=>{const t=document.getElementById(e);if(!t)throw new Error("input element not found");return t})}function f(e,t){const n=Object.assign(Object.assign({},e),{items:o.nothing});return o.updatePiped(n,e=>l(e),e=>c(e,t),e=>d(e))}function b(e,t,n){return e.ddModel.andThen(()=>e.uuid.map(t=>{const r=u.moveSelection(e,n),i=r.items.andThen(e=>e.toMaybe()).andThen(e=>e.getSelectedIndex()).map(e=>{const n=g(u.comboItemHtmlId(t,e)).map(e=>(e.scrollIntoView(!1),!0));return o.Task.attempt(n,()=>a.noOp())}).withDefaultSupply(()=>o.Cmd.none());return o.Tuple.t2n(r,i)})).withDefaultSupply(()=>f(e,t))}t.init=function(){const e=o.Task.perform(o.uuid(),e=>({tag:"got-uuid",uuid:e}));return[u.initialModel(),e]},t.update=function(e,t,n){switch(t.tag){case"got-uuid":return s(n,o.noCmd(Object.assign(Object.assign({},n),{uuid:o.just(t.uuid)})));case"input-value-changed":{const o=Object.assign(Object.assign({},n),{value:t.value});return s(n,c(o,e))}case"trigger-clicked":return s(n,f(n,e));case"dd-msg":return s(n,n.ddModel.map(e=>{const r=i.dropDownUpdate(t.child,e);if(r[2])return o.noCmd(Object.assign(Object.assign({},n),{ddModel:o.nothing}));const u=Object.assign(Object.assign({},n),{ddModel:o.just(r[0])});return o.Tuple.t2n(u,r[1].map(e=>a.dropDownMsg(e)))}).withDefaultSupply(()=>o.noCmd(n)));case"input-blurred":return s(n,l(n));case"input-focused":return s(n,o.noCmd(n));case"input-key-down":switch(t.key){case"Escape":return s(n,l(n));case"Enter":return s(n,n.items.andThen(e=>e.toMaybe()).andThen(e=>e.getSelected()).map(t=>m(n,e,t)).withDefaultSupply(()=>o.noCmd(n)));case"ArrowUp":return s(n,b(n,e,!0));case"ArrowDown":return s(n,b(n,e,!1));default:return s(n,o.noCmd(n))}case"got-items-from-provider":{if(t.fetchCount!==n.fetchCount)return s(n,o.noCmd(n));const e=Object.assign(Object.assign({},n),{items:o.just(t.res.map(o.ListWithSelection.fromArray))});return s(n,n.ddModel.map(()=>d(e)).withDefaultSupply(()=>o.noCmd(n)))}case"item-clicked":return s(n,m(n,e,t.item));case"noop":return s(n,o.noCmd(n))}},t.subscriptions=function(e){return o.Sub.none()}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.noOp=t.gotItems=t.inputFocused=t.dropDownMsg=void 0,t.dropDownMsg=function(e){return{tag:"dd-msg",child:e}},t.inputFocused=function(e){return{tag:"input-focused",res:e}},t.gotItems=function(e,t){return{tag:"got-items-from-provider",res:e,fetchCount:t}},t.noOp=function(){return{tag:"noop"}}},function(e,t,n){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n),Object.defineProperty(e,o,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),r=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.hasOwnProperty.call(e,n)&&o(t,e,n);return r(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.ViewComboBox=void 0;const u=i(n(1)),a=n(8),c=n(27);t.ViewComboBox=function(e){const t=e.model,n=e.dispatch,o=e.renderer,r=t.value;return t.uuid.map(e=>u.createElement("div",{className:"tp-combobox"},o.renderInput({id:c.comboHtmlId(e),value:r,onChange:e=>n({tag:"input-value-changed",value:e}),onBlur:()=>n({tag:"input-blurred"}),onKeyDown:e=>n({tag:"input-key-down",key:e}),onTriggerClick:()=>n({tag:"trigger-clicked"})}),t.ddModel.map(i=>u.createElement(a.ViewDropDown,{model:i,renderer:()=>{const i=(i,a)=>{const s=t.items.andThen(e=>e.toMaybe()).andThen(e=>e.getSelectedIndex()).map(e=>e===a).withDefault(!1),m=["tp-combobox-item"].concat(s?["tp-selected"]:[]);return u.createElement("div",{id:c.comboItemHtmlId(e,a),key:a,className:m.join(" "),onMouseDown:()=>n({tag:"item-clicked",item:i})},o.renderItem({item:i,index:a,value:r}))};return u.createElement("div",{className:"tp-combobox-items"},t.items.map(e=>e.match(e=>0===e.length()?u.createElement("div",{className:"tp-combobox-no-matches"},o.renderNoMatches()):u.createElement(u.Fragment,null,e.toArray().map(i)),e=>u.createElement("div",{className:"tp-combo-error"},e.message))).withDefaultSupply(()=>u.createElement("div",{className:"tp-combobox-loading"},o.renderLoading())))}})).withDefault(u.createElement(u.Fragment,null)))).withDefault(u.createElement(u.Fragment,null))}},function(e,t,n){"use strict";n.r(t);var o=n(1),r=n.n(o),i=n(28),u=n.n(i),a=(n(34),n(0));const c={tag:"noop"};function s(e){return{tag:"menu-page-msg",msg:e}}function m(e){return{tag:"dd-page-msg",msg:e}}function d(e){return{tag:"placement-page-msg",msg:e}}function l(e){return{tag:"combo-page-msg",msg:e}}var p=n(4);const g=new p.Router(p.route0.map(()=>"home"),Object(p.route1)(Object(p.str)("menu")).map(()=>"menu"),Object(p.route1)(Object(p.str)("dropdown")).map(()=>"dropdown"),Object(p.route1)(Object(p.str)("placement")).map(()=>"placement"),Object(p.route1)(Object(p.str)("combo")).map(()=>"combo"));function f(e){switch(e){case"home":return"/";default:return"/"+e}}var b=n(2),h=n(5);function w(e){return{tag:"menu-msg",msg:e}}const j=Object(h.defaultItemRenderer)(e=>o.createElement("span",null,e));var O=n(3);const v=Object(h.menu)([Object(h.item)("Try"),Object(h.item)("Finally")]),y=Object(h.menu)([Object(h.item)("Do this"),Object(h.item)("Do that"),h.separator,Object(h.item)("Another sub menu...",v)]),D=Object(h.menu)([Object(h.item)("Yalla",y),h.separator,Object(h.item)("Copy"),Object(h.item)("Cut"),Object(h.item)("Paste"),h.separator,Object(h.item)("I am a bit longer")]);function M(e,t){switch(e.tag){case"menu-msg":return t.menuModel.map(n=>{const o=Object(h.update)(e.msg,n),r=Object(O.a)(Object(O.a)({},t),{},{menuModel:Object(a.just)(o[0])}),i=o[1].map(w);return o[2].map(e=>{switch(e.tag){case"request-close":{const e=E(r);return a.Tuple.fromNative(e).mapSecond(e=>a.Cmd.batch([i,e])).toNative()}case"item-selected":{const t=E(r,Object(a.just)(e.data));return a.Tuple.fromNative(t).mapSecond(e=>a.Cmd.batch([i,e])).toNative()}}}).withDefaultSupply(()=>a.Tuple.t2n(r,i))}).withDefaultSupply(()=>Object(a.noCmd)(t));case"mouse-down":return 2===e.button?x(t,Object(h.open)(D,Object(b.box)(t.mousePos,b.Dim.zero))):Object(a.noCmd)(t);case"mouse-move":return Object(a.noCmd)(Object(O.a)(Object(O.a)({},t),{},{mousePos:e.pos}));case"key-down":return"ContextMenu"===e.key?x(t,Object(h.open)(D,Object(b.box)(t.mousePos,b.Dim.zero))):Object(a.noCmd)(t)}}const C=new p.DocumentEvents;function x(e,t){return a.Tuple.fromNative(t).mapFirst(t=>Object(O.a)(Object(O.a)({},e),{},{menuModel:Object(a.just)(t)})).mapSecond(e=>e.map(w)).toNative()}function E(e,t=a.nothing){return Object(a.noCmd)(Object(O.a)(Object(O.a)({},e),{},{menuModel:a.nothing,lastClicked:t}))}n(65);var _=n(8);function S(e){return{tag:"dd-msg",msg:e}}function k(e){return{tag:"got-window-dimensions",d:e}}function I(e,t){switch(e.tag){case"button-clicked":{const n=Object(_.dropDownOpen)(a.Task.succeed(e.b)),o=Object(O.a)(Object(O.a)({},t),{},{indexAndModel:Object(a.just)(new a.Tuple(e.index,n[0]))});return a.Tuple.t2n(o,n[1].map(S))}case"dd-msg":return t.indexAndModel.map(n=>{const o=Object(_.dropDownUpdate)(e.msg,n.b);if(o[2]){const e=Object(O.a)(Object(O.a)({},t),{},{indexAndModel:a.nothing});return Object(a.noCmd)(e)}return a.Tuple.fromNative([o[0],o[1]]).mapFirst(e=>Object(O.a)(Object(O.a)({},t),{},{indexAndModel:t.indexAndModel.map(t=>new a.Tuple(t.a,e))})).mapSecond(e=>e.map(S)).toNative()}).withDefaultSupply(()=>Object(a.noCmd)(t));case"got-window-dimensions":return Object(a.noCmd)(Object(O.a)(Object(O.a)({},t),{},{viewportDim:Object(a.just)(e.d)}))}}const P=new p.WindowEvents;function N(e){return{tag:"got-window-dimensions",d:e}}function T(e,t){switch(e.tag){case"got-window-dimensions":return Object(a.noCmd)(Object(O.a)(Object(O.a)({},t),{},{viewportDim:Object(a.just)(e.d)}));case"key-down":return Object(a.noCmd)("m"===e.key?Object(O.a)(Object(O.a)({},t),{},{mode:"menu"===t.mode?"drop-down":"menu"}):t);case"mouse-move":return Object(a.noCmd)(Object(O.a)(Object(O.a)({},t),{},{mousePos:e.pos}))}}const B=new p.DocumentEvents,F=new p.WindowEvents;var A=n(9);function L(e){return{tag:"tea-pop-combobox-msg",child:e}}const W=[];for(let Z=0;Z<100;Z++)W.push("i"+Z+" is my item "+Z);const R=new class{itemToString(e){return e}fetchItems(e){return a.Task.succeedLazy(()=>(console.log("provider "+e),""===e?W:W.filter(t=>-1!==t.indexOf(e))))}};function z(e,t){switch(e.tag){case"tea-pop-combobox-msg":{const n=Object(A.comboBoxUpdate)(R,e.child,t.comboModel);n[2].forEach(e=>{console.log("out",e)});return[Object(O.a)(Object(O.a)({},t),{},{comboModel:n[0]}),n[1].map(L)]}}}class H{renderItem(e){return o.createElement("div",{className:"my-item"},e.item)}renderLoading(){return o.createElement("div",null,"Loading...")}renderNoMatches(){return o.createElement("div",null,"No matches !")}renderInput(e){return o.createElement("div",{className:"my-cb-input"},o.createElement("input",{id:e.id,value:e.value,onChange:t=>{const n=t.target.value;e.onChange(n)},onBlur:()=>e.onBlur(),onKeyDown:t=>e.onKeyDown(t.key)}),o.createElement("button",{onClick:()=>e.onTriggerClick()},"\u2304"))}}function V(e){return g.parseLocation(e).map(e=>{switch(e){case"home":return U();case"menu":return a.Tuple.fromNative(Object(a.noCmd)({tag:"menu",mousePos:b.Pos.origin,lastClicked:a.nothing,menuModel:a.nothing})).mapFirst(e=>({page:e})).mapSecond(e=>e.map(s)).toNative();case"dropdown":return a.Tuple.fromNative(function(){const e=a.Task.succeedLazy(()=>Object(b.windowDimensions)()),t={tag:"drop-down-page",viewportDim:a.nothing,indexAndModel:a.nothing};return a.Tuple.t2n(t,a.Task.perform(e,k))}()).mapFirst(e=>({page:e})).mapSecond(e=>e.map(m)).toNative();case"placement":return a.Tuple.fromNative(function(){const e={tag:"placement-page",viewportDim:a.nothing,mode:"menu",mousePos:b.Pos.origin},t=a.Task.perform(a.Task.succeedLazy(()=>Object(b.dim)(window.innerWidth,window.innerHeight)),N);return a.Tuple.t2n(e,t)}()).mapFirst(e=>({page:e})).mapSecond(e=>e.map(d)).toNative();case"combo":return a.Tuple.fromNative(function(){const e=Object(A.comboBoxInit)();return[{tag:"combo-page",comboModel:e[0]},e[1].map(L)]}()).mapFirst(e=>({page:e})).mapSecond(e=>e.map(l)).toNative()}}).withDefaultSupply(()=>U())}function U(){return Object(a.noCmd)({page:{tag:"home"}})}function K(e,t,n){return o.createElement("a",{href:"#",onClick:n=>{n.preventDefault(),e(function(e){return{tag:"navigate",route:e}}(t))}},n)}function J(e,t){const n=t.page;switch(n.tag){case"home":return o.createElement(o.Fragment,null,o.createElement("h1",null,"tea-pop demo app"),o.createElement("ul",null,o.createElement("li",null,K(e,"menu","Context menu")),o.createElement("li",null,K(e,"dropdown","Drop-down")),o.createElement("li",null,K(e,"combo","Combobox")),o.createElement("li",null,K(e,"placement","Live placement"))));case"menu":return function(e,t){return o.createElement("div",{className:"demo-menu",onContextMenu:b.stopEvent,onMouseDown:t=>e({tag:"mouse-down",button:t.button})},o.createElement("div",{className:"demo-content"},t.menuModel.map(()=>o.createElement("span",null,"Menu is open")).withDefaultSupply(()=>t.lastClicked.map(e=>o.createElement("span",null,"You selected ",o.createElement("em",null,e))).withDefaultSupply(()=>o.createElement(o.Fragment,null,o.createElement("div",{className:"stuff"},"Right-click anywhere, or use the ",o.createElement("code",null,"\u2263")," key.")))),t.menuModel.map(t=>o.createElement(h.ViewMenu,{model:t,dispatch:Object(a.map)(e,w),renderer:j})).withDefault(o.createElement(o.Fragment,null))))}(Object(a.map)(e,s),n);case"drop-down-page":return function(e,t){return t.viewportDim.map(n=>{const r=Math.floor(n.w/10),i=Math.floor(n.h/10),u=[];let a=1;const c=i-8,s=r-8;for(let m=0;m+4+s<n.w;m+=r)for(let r=0;r+4+c<n.h;r+=i){const n=a,i=r+4,d=m+4,l=t.indexAndModel.map(e=>e.a).filter(e=>e===n).map(()=>"lightblue").withDefault("lightgray");u.push(o.createElement("button",{key:"btn"+a,style:{position:"absolute",top:i,left:d,height:c,width:s,border:"none",backgroundColor:l},onClick:t=>e({tag:"button-clicked",index:n,b:b.Box.fromDomRect(t.target.getBoundingClientRect())})},a)),a++}return o.createElement(o.Fragment,null,o.createElement("div",{className:"drop-down-page"},u),t.indexAndModel.map(e=>o.createElement(_.ViewDropDown,{renderer:()=>o.createElement("div",{className:"my-drop-down"},"HELLO"),model:e.b})).withDefaultSupply(()=>o.createElement(o.Fragment,null)))}).withDefaultSupply(()=>o.createElement(o.Fragment,null))}(Object(a.map)(e,m),n);case"placement-page":return function(e,t){return t.viewportDim.map(e=>{let n="menu"===t.mode?b.place:b.placeCombo;const r=t.mousePos,i=Object(b.dim)(600,400),u=Object(b.dim)(100,50),a=n(e,Object(b.box)(Object(b.pos)(r.x,r.y),u),i),c=e=>o.createElement("span",null,e.w,"*",e.h),s=e=>o.createElement("span",null,e.x,":",e.y);return o.createElement("div",{className:"demo"},o.createElement("div",{className:"dimensions"},o.createElement("ul",null,o.createElement("li",null,"mode: ",t.mode," (toggle with ",o.createElement("code",null,"M"),")"),o.createElement("li",null,"elem: ",c(i)),o.createElement("li",null,"viewport: ",c(e)),o.createElement("li",null,"ref: ",c(u)),o.createElement("li",null,"mousePos: ",s(r)),o.createElement("li",null,"placed: ",s(a.p),", ",c(a.d)))),o.createElement("div",{className:"ref-elem",style:{height:u.h,width:u.w,left:t.mousePos.x,top:t.mousePos.y}}),o.createElement("div",{className:"menu-elem",style:{height:a.d.h,width:a.d.w,left:a.p.x,top:a.p.y}}))}).withDefaultSupply(()=>o.createElement(o.Fragment,null))}(Object(a.map)(e,d),n);case"combo-page":return function(e,t){return o.createElement("div",{className:"combo-page"},o.createElement("h1",null,"ComboBox sample"),o.createElement(A.ViewComboBox,{dispatch:Object(a.map)(e,L),model:t.comboModel,renderer:new H}))}(Object(a.map)(e,l),n)}}function q(e,t,n,o){const r=n(e,t),i={page:r[0]},u=r[1].map(o);return a.Tuple.t2n(i,u)}function Y(e,t){switch(e.tag){case"url-change":return V(e.l);case"menu-page-msg":{const n=t.page;return"menu"!==n.tag?Object(a.noCmd)(t):q(e.msg,n,M,s)}case"dd-page-msg":{const n=t.page;return"drop-down-page"!==n.tag?Object(a.noCmd)(t):q(e.msg,n,I,m)}case"placement-page-msg":{const n=t.page;return"placement-page"!==n.tag?Object(a.noCmd)(t):q(e.msg,n,T,d)}case"combo-page-msg":{const n=t.page;return"combo-page"!==n.tag?Object(a.noCmd)(t):q(e.msg,n,z,l)}case"navigate":return a.Tuple.t2n(t,a.Task.perform(Object(p.newUrl)(f(e.route)),()=>c));case"noop":return Object(a.noCmd)(t)}}function X(e){const t=e.page;switch(t.tag){case"menu":return function(e){const t=e.menuModel.map(e=>Object(h.subscriptions)(e).map(w)).withDefaultSupply(()=>a.Sub.none()),n=C.on("mousemove",e=>({tag:"mouse-move",pos:Object(b.pos)(e.clientX,e.clientY)})),o=C.on("keydown",e=>({tag:"key-down",key:e.key}));return a.Sub.batch([t,n,o])}(t).map(s);case"drop-down-page":return a.Sub.batch([Object(_.dropDownSubscriptions)().map(S),P.on("resize",()=>k(Object(b.dim)(window.innerWidth,window.innerHeight)))]).map(m);case"placement-page":return function(){const e=B.on("mousemove",e=>({tag:"mouse-move",pos:Object(b.pos)(e.pageX,e.pageY)})),t=B.on("keydown",e=>({tag:"key-down",key:e.key}));return a.Sub.batch([e,t,F.on("resize",e=>N(Object(b.dim)(window.innerWidth,window.innerHeight)))])}().map(d);case"combo-page":return function(e){return Object(A.comboBoxSubscriptions)(e.comboModel).map(L)}(t).map(l);default:return a.Sub.none()}}function G(e){return{tag:"url-change",l:e}}const Q=()=>o.createElement(p.ProgramWithNav,{onUrlChange:G,init:V,view:J,update:Y,subscriptions:X,devTools:p.DevTools.init(window)});u.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(Q,null)),document.getElementById("root"))}],[[29,1,2]]]);
//# sourceMappingURL=main.19820f07.chunk.js.map